{#
    Copyright DB InfraGO AG and contributors
    SPDX-License-Identifier: Apache-2.0
#}

{% from 'common_macros.html.j2' import linked_name, description %}
{% from 'polarion_props.j2' import table_attributes, th_attributes, td_attributes %}

{% macro describe_exchange(object) %}
{%- set source_function = object.source.owner -%}
{%- set target_function = object.target.owner -%}
{%- set source = source_function.owner -%}
{%- set target = target_function.owner -%}
The {{ source | link_work_item }} shall provide {{ object | link_work_item }} to {{ target | link_work_item }} so that the {{ target | link_work_item }} could {{ target_function | link_work_item }}.
{% endmacro %}

<span style="font-weight: bold;font-size: 12pt;line-height: 1.5;">Interface Partners</span>
<p>This logical interface connects between {{ object.source.owner | link_work_item}} and {{ object.target.owner | link_work_item}}.</p>
<p>The need for the interface is explained and requirements are provided so that the interface partners could find an appropriate interface definition (solution).</p>
<h2>Enabled interactions</h2>
<p>The figure below provides an overview of the behaviors that depend on this interface:</p>
{{ object.context_diagram.as_html_img | safe }}
<p>This interface enables the following interactions:</p>
<table {{table_attributes}}>
    <thead>
        <tr>
            <th {{th_attributes}}>ID</th>
            <th {{th_attributes}}>Interaction description</th>
        </tr>
    </thead>
    <tbody>
    {% for exchange in object.allocated_functional_exchanges %}
        <tr>
            <td {{td_attributes}}>{{ exchange | link_work_item }}</td>
            <td {{td_attributes}}>
                {{ describe_exchange(exchange) | safe }}
                {% if exchange.exchange_items |Â length > 1 %}
                <p>{{ exchange.name }} is further specified via the following Exchange Items:</p>
                <ul>
                    {% for item in exchange.exchange_items %}
                    <li>{{ item | link_work_item }}</li>
                    {% endfor %}
                </ul>
                {% elif exchange.exchange_items %}
                <p>This interaction is further specified via {{ exchange.exchange_items[0] | link_work_item}}.</p>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>

